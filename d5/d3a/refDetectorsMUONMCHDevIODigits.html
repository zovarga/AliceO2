<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: DigitsIO</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d3a/refDetectorsMUONMCHDevIODigits.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">DigitsIO </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="../../#utilities-to-read-and-write-mch-digits-in-non-ctf-formats-mostly-for-debug">Utilities to read and write MCH Digits in non-CTF formats (mostly for debug)</a><ul>
<li><a href="../../#standalone-programs-ie-not-dpl-devices">Standalone programs (i.e. not DPL devices)</a><ul>
<li><a href="../../#digit-file-dumper">Digit file dumper</a></li>
</ul>
</li>
<li><a href="../../#dpl-devices">DPL devices</a><ul>
<li><a href="../../#digit-file-reader-aka-sampler-device">Digit file reader (aka sampler) device</a></li>
<li><a href="../../#digit-writer-aka-sink-device">Digit writer (aka sink) device</a></li>
<li><a href="../../#digit-id-converter-from-run2-to-run3">Digit ID converter (from Run2 to Run3)</a></li>
<li><a href="../../#digit-random-generator">Digit random generator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>Utilities to read and write MCH Digits in non-CTF formats (mostly for debug)</h1>
<p>The MCH digits can be stored in binary format for debug purpose.</p>
<p>The file they are stored in can currently be of two different formats : with or without associated ROFRecord. In both cases the digits themselves (currently) have the same version (named D0). The file version number changes whenever the file structure changes or the format of the objects it contain changes.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">File version </th><th class="markdownTableHeadCenter">Digit version </th><th class="markdownTableHeadCenter">contains ROF </th><th class="markdownTableHeadCenter">ROF version </th><th class="markdownTableHeadCenter">support  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">0 </td><td class="markdownTableBodyCenter">0 </td><td class="markdownTableBodyCenter">no </td><td class="markdownTableBodyCenter">(0) </td><td class="markdownTableBodyCenter">yes  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">1 </td><td class="markdownTableBodyCenter">0 </td><td class="markdownTableBodyCenter">yes </td><td class="markdownTableBodyCenter">1 </td><td class="markdownTableBodyCenter">yes  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2 </td><td class="markdownTableBodyCenter">1 </td><td class="markdownTableBodyCenter">yes </td><td class="markdownTableBodyCenter">1 </td><td class="markdownTableBodyCenter">planned  </td></tr>
</table>
<h2>Standalone programs (i.e. not DPL devices)</h2>
<h3>Digit file dumper</h3>
<div class="fragment"><div class="line">options:</div>
<div class="line">  -h [ --help ]          produce help message</div>
<div class="line">  -i [ --infile ] arg    input file name</div>
<div class="line">  -c [ --count ]         count items (rofs, tfs, etc...)</div>
<div class="line">  -d [ --describe ]      describe file format</div>
<div class="line">  -p [ --print-digits ]  print digits</div>
<div class="line">  -t [ --print-tfs ]     print number of digits and rofs per tf</div>
<div class="line">  --max-nof-tfs arg      max number of timeframes to process</div>
<div class="line">  --first-tf arg         first timeframe to process</div>
</div><!-- fragment --><h2>DPL devices</h2>
<p>Those are (partial) DPL workflows to be used to form bigger workflows using pipes.</p>
<h3>Digit file reader (aka sampler) device</h3>
<p>Reads a binary file containing digits. The binary format should be embedded in the file directly. If the reader cannot identify the format it will assume it is the <a class="el" href="../../df/d0e/structV0.html">V0</a> version, which might or not might be the case...</p>
<div class="fragment"><div class="line">o2-mch-digits-file-reader-workflow</div>
<div class="line">  --infile arg       input file name</div>
<div class="line">  [--max-nof-tfs]    max number of timeframes to process</div>
<div class="line">  [--first-tf]       first timeframe to process</div>
<div class="line">  [--max-nof-rofs]   max number of ROFs to process</div>
<div class="line">  [--repack-rofs]    number of rofs to repack into a timeframe</div>
<div class="line">                     (aka min number of rofs per timeframe)</div>
<div class="line">  [--print-digits]   print digits</div>
<div class="line">  [--print-tfs]      print number of digits and rofs per tf</div>
</div><!-- fragment --><h3>Digit writer (aka sink) device</h3>
<div class="fragment"><div class="line">o2-mch-digits-file-writer-workflow</div>
<div class="line">  [--outfile] arg (=digits.out)       output file name</div>
<div class="line">  [--max-nof-tfs] arg (=2147483647)   max number of timeframes to process</div>
<div class="line">  [--first-tf] arg (=0)               first timeframe to process</div>
<div class="line">  [--no-file]                         no output to file</div>
<div class="line">  [--binary-file-format] arg (=v1)    digit binary format to use</div>
<div class="line">  [--print-digits]                    print digits</div>
<div class="line">  [--print-tfs]                       print number of digits and rofs per tf</div>
<div class="line">  [--txt]                             output digits in text format</div>
<div class="line">  [--max-size] arg (=2147483647)      max output size (in KB)</div>
</div><!-- fragment --><p>Take as input a list of digits in timeframes (and optionally their associated Orbits) and dump them into a file (binary or text if <code>--txt</code> option is used) or to screen (if <code>--no-file</code> option is used)</p>
<h3>Digit ID converter (from Run2 to Run3)</h3>
<div class="fragment"><div class="line">o2-mch-digits-r23-workflow</div>
<div class="line">  [--verbose]        print ids being converted</div>
</div><!-- fragment --><p><a class="el" href="../../d2/d88/classA.html">A</a> device that reads digits with ids in Run2 convention and outputs digits with ids in Run3 convention. Note that expected input spec is <code>MCH/DIGITSRUN2</code> and the output one is <code>MCH/DIGITS</code></p>
<h3>Digit random generator</h3>
<div class="fragment"><div class="line">o2-mch-digits-random-generator-workflow</div>
<div class="line">  [--first-tf] arg (=0)               first timeframe to generate</div>
<div class="line">  [--max-nof-tfs] arg (=2147483647)   max number of timeframes to generate</div>
<div class="line">  [--nof-rofs-per-tf]                 number of ROFs to generate in each timeframe</div>
<div class="line">  [--occupancy]                       fraction of pads to generate digits for</div>
<div class="line">  [--print-digits]                    print digits</div>
<div class="line">  [--print-tfs]                       print number of digits and rofs per tf</div>
</div><!-- fragment --><p>Generate a fixed number of digits (equal to the total number of MCH pads times the occupancy) per ROFRecord for a fixed number of ROFRecord per time frames, for a fixed number of timeframes.</p>
<p>Note that the occupancy <b>must</b> be strictly positive and less than or equal to 1.</p>
<p>Example of use : generate digits (with 1% occupancy, 128 ROFs per <a class="el" href="../../d5/d14/structTF.html">TF</a>, 10 TFs) and dump them into debug binary form :</p>
<div class="fragment"><div class="line">o2-mch-digits-random-generator-workflow -b</div>
<div class="line">  --max-nof-tfs 10 </div>
<div class="line">  --nof-rofs-per-tf 128 </div>
<div class="line">  --occupancy 0.01 | </div>
<div class="line">o2-mch-digits-writer-workflow -b </div>
<div class="line">  --print-tfs </div>
<div class="line">  --binary-file-format 1 </div>
<div class="line">  --outfile digits.v1.out</div>
</div><!-- fragment --><div class="fragment"><div class="line">$ ls -alrth digits.v1.out</div>
<div class="line">-rw-r--r--  1 laurent  staff   258M 15 avr 10:30 digits.v1.out</div>
<div class="line"> </div>
<div class="line">$ o2-mch-digits-file-dumper --infile digits.v1.out -c -d</div>
<div class="line">[ file version 1 digit version 0 size 20 rof version 1 size 16 hasRof true run2ids false ] formatWord 1224998065220435759</div>
<div class="line">nTFs 10 nROFs 1280 nDigits 13506560</div>
</div><!-- fragment --><p>The generated digit file can then be injected into other workflows using <code>o2-mch-digits-file-reader-workflow</code> described above. (digits do not <em>need</em> to be written to disc, the <code>o2-mch-digits-random-generator-workflow</code> can of course also be used as the first stage of a multi device workflow using pipes). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d2f/refDetectors.html">Module &#39;Detectors&#39;</a></li><li class="navelem"><a class="el" href="../../d4/dff/refDetectorsMUON.html">MUON</a></li><li class="navelem"><a class="el" href="../../d0/daf/refDetectorsMUONMCH.html">MCH</a></li><li class="navelem"><a class="el" href="../../d9/d45/refDetectorsMUONMCHDevIO.html">DevIO</a></li>
    <li class="footer">Generated on Mon Feb 14 2022 05:41:08 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
