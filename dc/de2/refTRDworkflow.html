<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: TRD workflow</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/de2/refTRDworkflow.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">TRD workflow </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>DPL workflows for the TRD</h1>
<h2>TRD reconstruction workflow</h2>
<p>The TRD reconstruction workflow requires TRD tracklets, TRD trigger records and as additional input either TPC tracks, ITS-TPC matches, or both. Take a look at the Input data section to see how to generate the input from a simulation.</p>
<p>The reconstruction workflow consists of the following DPL processors:</p>
<ul>
<li><code>TRDTrackletReader</code></li>
<li><code>tpc-track-reader</code></li>
<li><code>itstpc-track-reader</code></li>
<li><code>trd-globaltracking[TPC_ITS-TPC]</code> using <a href="../../../../../../tree/dev/GPU/GPUTracking/TRDTracking/GPUTRDTracker.h">o2::gpu::GPUTRDTracker_t&lt;TrackType,PropagatorType&gt;</a></li>
<li><code>trd-trackbased-calib</code> using <a href="../../../../../../tree/dev/Detectors/TRD/calibration/include/TRDCalibration/TrackBasedCalib.h">o2::trd::TrackBasedCalib</a></li>
<li><code>trd-track-writer-tpc</code></li>
<li><code>trd-track-writer-tpcits</code></li>
<li><code>TRDCalibWriter</code></li>
</ul>
<p>The different track reader and writer are only added to the workflow if the respective tracking source is configured. The workflow is started with the command: <code>o2-trd-global-tracking</code>. Available options are:</p><ul>
<li><code>--disable-mc</code> disable MC labels</li>
<li><code>--disable-root-input</code> the input is provided by another DPL device</li>
<li><code>--disable-root-output</code> the output is not written to file</li>
<li><code>--track-sources ITS-TPC,TPC</code> a comma-seperated list of sources to use for the tracking. Default is <code>ALL</code> which results in the same workflow as <code>ITS-TPC,TPC</code></li>
<li><code>--strict-matching</code> if enabled, TPC-TRD tracks which have another hypothesis close to the best one are flagged as ambiguous and not written out. The minimum chi2 gap between best and second best hypothesis can be configured with <code>GPU_rec_trd.chi2SeparationCut</code></li>
<li><code>--filter-trigrec</code> if enabled, the trigger records for which no ITS information is available are ignored. Per default on in the synchronous reconstruction, since there is no matching to TPC-only tracks in that case.</li>
<li><code>--configKeyValues "GPU_rec_trd.nSigmaTerrITSTPC=4;"</code> only one example for the different options for the TRD tracker. All are listed in <a href="../../../../../../dev/GPU/GPUTracking/Definitions/GPUSettingsList.h">GPUSettingsList.h</a>. Search for GPUSettingsRecTRD</li>
</ul>
<h2>Input data</h2>
<p>Since the TRD reconstruction requires either ITS-TPC or TPC tracks to run there are some additional steps to be taken next to the simulation and digitization of an example data sample: These commands will generate a small pp data sample with 10 events:</p><ul>
<li><code>o2-sim -n 10 -g pythia8pp --skipModules ZDC</code></li>
<li><code>o2-sim-digitizer-workflow -b</code> this will create both TRD digits and TRD tracklets</li>
<li><code>o2-tpc-reco-workflow -b --input-type digits --output-type clusters,tracks --configKeyValues "GPU_proc.ompThreads=4;" --shm-segment-size 10000000000 --run</code></li>
<li><code>o2-its-reco-workflow -b --trackerCA --tracking-mode async --shm-segment-size 10000000000 --run</code></li>
<li><code>o2-tpcits-match-workflow -b --tpc-track-reader tpctracks.root --tpc-native-cluster-reader "--infile tpc-native-clusters.root" --shm-segment-size 10000000000 --run</code></li>
<li><code>o2-trd-tracklet-transformer -b --filter-trigrec</code> if the trigger filter is active here, it must also be active for the TRD tracking. Otherwise an error will be thrown</li>
<li><code>o2-trd-global-tracking -b --filter-trigrec</code></li>
</ul>
<p>Of course one can also concatenate the workflows. For example:<code>o2-trd-tracklet-transformer -b --disable-root-output | o2-trd-global-tracking -b</code>. This will create the calibrated tracklets on-the-fly and not create the <code>trdcalibratedtracklets.root</code> file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Feb 14 2022 05:41:08 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
