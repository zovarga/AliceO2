<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: Common</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/d1e/refDetectorsMUONCommon.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Common </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Common code for MID and MCH</h1>
<p>For the moment the only commonality stems from the DCS to CCDB part, as both subsystems only transmit DCS datapoints to CCDB, without any particular treatment. So we use almost the same source code, but generate separate executables, e.g. to ease the integration with <code>dcs-proxy</code>-based workflows.</p>
<p>Note that MCH transmit both the HV and LV values to CCDB, while MID only transmit HV values.</p>
<h2>DCS to CCDB</h2>
<p>To test the DCS to CCDB route you can use the following 3 parts worfklow pipeline :</p>
<div class="fragment"><div class="line">o2-calibration-mch-dcs-sim-workflow --max-timeframes 600 --max-cycles-no-full-map 10 -b | \</div>
<div class="line">o2-calibration-mch-dcs-processor-workflow --hv-max-size 0 --hv-max-duration 300 --lv-max-size 0 --lv-max-duration 300 -b | \</div>
<div class="line">o2-calibration-ccdb-populator-workflow --ccdb-path=&quot;http://localhost:6464&quot; -b</div>
</div><!-- fragment --><div class="fragment"><div class="line">o2-calibration-mid-dcs-sim-workflow --max-timeframes 600 --max-cycles-no-full-map 10 -b | \</div>
<div class="line">o2-calibration-mid-dcs-processor-workflow --hv-max-size 0 --hv-max-duration 300 -b | \</div>
<div class="line">o2-calibration-ccdb-populator-workflow --ccdb-path=&quot;http://localhost:6464&quot; -b</div>
</div><!-- fragment --><p>Note that the only difference (besides the mid vs mch naming) is the set of options of the <code>processor</code> device (handling just hv for mid and hv+lv for mch).</p>
<ul>
<li><code>o2-calibration-[mch|mid]-dcs-sim-worfklow</code> is just generating fake random MCH or MID DCS data points,</li>
<li><code>o2-calibration-[mch|mid]-dcs-processor-workflow</code> gathers the received data points into a container object</li>
<li><p class="startli"><code>o2-calibration-ccdb-populator-workflow</code> uploads the container object to the CCDB (in this example a local dev ccdb).</p>
<p class="startli">The container object that groups the datapoints is considered ready to be shipped either when the data points span a long enough duration (see the <code>--xxx-max-duration</code> option(s) of the <code>o2-calibration-[mch|mid]-dcs-processor-workflow</code>) or is big enough (see the <code>--xxx-max-size</code> option(s)).</p>
</li>
</ul>
<h2>MCH DCS Data Points</h2>
<h3>HV</h3>
<p>The MCH high voltage (HV) system is composed of 188 channels :</p>
<ul>
<li>48 channels for stations 1 and 2 (3 HV channel per quadrant x 16 quadrants)</li>
<li>140 channels for stations 3, 4, 5 (1 HV channel per slat x 140 slats)</li>
</ul>
<h3>LV</h3>
<p>The MCH low voltage (LV) system is composed of 328 channels :</p>
<ul>
<li>216 channels (108 x 2 different voltage values) to power up the front-end electronics (dualsampas)</li>
<li>112 channels to power up the readout crates hosting the solar (readout) cards</li>
</ul>
<h2>MID DCS Data Points</h2>
<h3>HV</h3>
<p>The MID high voltage (HV) system is composed of 72 channels, one channel per RPC.</p>
<h2>CCDB quick check</h2>
<p>Besides the web browsing of the CCDB, another quick check can be performed with the <code>o2-[mch|mid]-dcs-ccdb</code> program to dump the DCS datapoints (hv, lv, or both) or the datapoint config valid at a given timestamp.</p>
<div class="fragment"><div class="line">$ o2-mch-dcs-ccdb --help</div>
<div class="line">$ o2-mch-dcs-ccdb --ccdb http://localhost:6464 --query hv --query lv --query dpconf</div>
<div class="line">$ o2-mid-dcs-ccdb --ccdb http://localhost:6464 --query hv --query dpconf</div>
</div><!-- fragment --><p>The same programs can be used to upload to CCDB the DCS data point configuration for the dcs-proxy :</p>
<div class="fragment"><div class="line">$ o2-mch-dcs-ccdb --put-datapoint-config --ccdb http://localhost:8080</div>
<div class="line">$ o2-mid-dcs-ccdb --put-datapoint-config --ccdb http://localhost:8080</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d2f/refDetectors.html">Module &#39;Detectors&#39;</a></li><li class="navelem"><a class="el" href="../../d4/dff/refDetectorsMUON.html">MUON</a></li>
    <li class="footer">Generated on Mon Feb 14 2022 05:41:08 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
