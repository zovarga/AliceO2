<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: Calibration workflow</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d0/d0d/refFITcommoncalibration.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Calibration workflow </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>FIT Calibration workflow</h2>
<h3>Overview</h3>
<p>The module was implemented in a generic way. Adding new calibration object should be easy and intuitive. Calibration device uses <a href="https://github.com/AliceO2Group/AliceO2/tree/dev/Detectors/Calibration">https://github.com/AliceO2Group/AliceO2/tree/dev/Detectors/Calibration</a> for TimeFrame management (see link above for more detailed information).</p>
<h3>How to use TimeSlotCalibration?</h3>
<h4>It is required to define classes listed below to be able to use prepared TimeSlotCalibration module.</h4>
<ul>
<li>TimeSlot Container class (for current state of the code, example - <code>FT0ChannelTimeTimeSlotContainer</code>). Container is responsible for data storage (CFDTime, Charge, etc.) and providing data for calibration object generation</li>
<li>Calibration Info Object class (for current state of the code, example - <code>FT0CalibrationInfoObject</code>). This class is responsible for providing input data which will be saved in TimeSlot Container instance. (so we can assume it's simplified channel data type, with extracted data that will be required for calibration process)</li>
<li>Calibration Object class (for current state of the code, example - <code>FT0ChannelTimeCalibrationObject</code>, <code>FT0DummyCalibrationObject</code>) - representing correction values</li>
</ul>
<p>To conclude, data stored in calibration info object is required to fill TimeSlot container with data and that data stored in the container is needed to generate calibration object.</p>
<h3>Implementation details</h3>
<p>FITCalibration module is based on templates, so it can be used for FT0, FDD and FV0 calibration workflows. One has to define definition of the classes described above and also provide formula for calibration object generation.</p>
<h3>How to add new code, new calibration object?</h3>
<ul>
<li>Define your calibration object class (can be combined more than one into one class)</li>
<li>Define your timeslot container class (can be used for many calibration objects)</li>
<li>Define algorithm / function for calibration object generation. Add template specialization with your classes in <code>FITCalibrationObjectProducer</code> <code>generateCalibrationObject</code> method</li>
<li>Add template specialization for calibration object in <code>FitCalibrationApi</code>, define ccdb calib object path and also recipe how to store them in CCDB</li>
<li>Create separated workflow or add your <code>DataProcessorSpec</code> to main calibration workflow</li>
</ul>
<p>For example check <code>FT0CalibrationDummy-Workflow</code> which uses combined calibration object. It is also uses mechanism to retrieve (from CCDB) another calibration object needed for calibration. Before running this workflow it is required to run <code>makeDummyFt0CalibObjectInCCDB</code> macro to generate dummy object in the local CCDB instance.</p>
<h3>How to run these workflows?</h3>
<ul>
<li>Dummy: <code>root -l ~/alice/O2/Detectors/FIT/FT0/calibration/macros/makeDummyFT0CalibObjectInCCDB.C+</code> <code>o2-ft0-digits-reader-workflow | o2-calibration-ft0-tf-processor | o2-calibration-ft0-dummy-example | o2-calibration-ccdb-populator-workflow --ccdb-path=<a href="http://localhost:8080">http://localhost:8080</a> -b</code></li>
<li>Channel Time calibration: <code>o2-ft0-digits-reader-workflow | o2-calibration-ft0-tf-processor | o2-calibration-ft0-channel-offset-calibration | o2-calibration-ccdb-populator-workflow --ccdb-path=<a href="http://localhost:8080">http://localhost:8080</a> -</code></li>
<li>General calibration workflow (for now, the same as Channel Time calibration) <code>o2-ft0-digits-reader-workflow | o2-calibration-ft0-tf-processor | o2-calibration-ft0-calibration | o2-calibration-ccdb-populator-workflow --ccdb-path=<a href="http://localhost:8080">http://localhost:8080</a> -b</code></li>
</ul>
<p>You have to specify path to digits file in <code>o2-ft0-digits-reader-workflow</code>. If you don't need to store generated calib object you can delete last workflow part (<code>o2-calibration-ccdb-populator-workflow --ccdb-path=<a href="http://localhost:8080">http://localhost:8080</a> -b</code>) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d2f/refDetectors.html">Module &#39;Detectors&#39;</a></li><li class="navelem"><a class="el" href="../../da/d84/refDetectorsFIT.html">FIT</a></li>
    <li class="footer">Generated on Mon Feb 14 2022 05:41:08 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
